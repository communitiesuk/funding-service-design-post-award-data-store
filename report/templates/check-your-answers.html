{% extends "common/base.html" %}

{% from "govuk_frontend_jinja/components/back-link/macro.html" import govukBackLink %}

{% block beforeContent %}
  {{ super() }}
  {{ govukBackLink({'href': back_link}) }}
{% endblock %}

{% block content %}
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
      <div class="govuk-caption-xl">
        <span class="govuk-visually-hidden">This subsection is: </span>{{ subsection.name }}
      </div>
      <h1 class="govuk-heading-xl">
        Check your answers
      </h1>
      {% for navigated_form in subsection.navigated_forms() %}
        {% if navigated_form.instance_number == 0 %}
          <h2 class="govuk-heading-s">{{ navigated_form.page_id|replace("-", " ")|capitalize }}</h2>
        {% else %}
          <h2 class="govuk-heading-s">{{ navigated_form.page_id|replace("-", " ")|capitalize }} ({{ navigated_form.instance_number + 1 }})</h2>
        {% endif %}
        <dl class="govuk-summary-list">
          {% for field, value in navigated_form.form_data.items() %}
            <div class="govuk-summary-list__row">
              <dt class="govuk-summary-list__key">{{ field|replace("_", " ")|capitalize }}</dt>
              <dd class="govuk-summary-list__value">
                {{ value|capitalize }}
              </dd>
              <dd class="govuk-summary-list__actions">
                <a class="govuk-link govuk-link--no-visited-state" href="{{ get_form_page_url(programme=programme, project_ref=project_ref, section=section, subsection=subsection, page_id=navigated_form.page_id, instance_number=navigated_form.instance_number) }}">Change</a>
            </div>
          </dl>
        {% endfor %}
      {% endfor %}
      <div class="govuk-button-group">
        <form method="post" novalidate>
          <button type="submit" class="govuk-button">Submit</button>
        </form>
      </div>
    </div>

    {% block sidebar %}
    <div class="govuk-grid-column-one-third">
       <article class="app-ticket-panel">
         <section class="app-ticket-panel__content">
           <p class="govuk-body">
             <span class="govuk-!-font-weight-bold">Project:</span>
             {{ project_ref.project_name }}
           </p>
           <hr class="govuk-section-break--m">
           <p class="govuk-body">
             <span class="govuk-!-font-weight-bold">Reporting period:</span>
             July 2023 to September 2023
           </p>
         </section>
       </article>
    </div>
    {% endblock sidebar %}
  </div>
{% endblock %}
