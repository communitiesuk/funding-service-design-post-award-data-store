{% extends "common/base.html" %}

{% from "govuk_frontend_jinja/components/back-link/macro.html" import govukBackLink %}
{%- from 'govuk_frontend_jinja/components/button/macro.html' import govukLink -%}
{%- from 'govuk_frontend_jinja/components/summary-list/macro.html' import govukSummaryList %}
{% from "govuk_frontend_jinja/components/tag/macro.html" import govukTag %}

{% block beforeContent %}
  {{ super() }}
  {{ govukBackLink({'href': back_link}) }}
{% endblock %}

{% block content %}
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
      <span class="govuk-caption-xl">{{ programme.programme_name }} - {{ programme.fund.fund_name }}</span>
      <h1 class="govuk-heading-xl">Report for April 2024 to June 2024</h1>

      <h2 class="govuk-heading-m">Programme report</h2>
      <ul class="govuk-task-list">
        <li class="govuk-task-list__item govuk-task-list__item--with-link">
          <div class="govuk-task-list__name-and-hint">
            <a class="govuk-link govuk-task-list__link govuk-link--no-visited-state"
               href="#"
               aria-describedby="task-list-programme-overview-status">
              Programme overview
            </a>
          </div>

          <div class="govuk-task-list__status" id="task-list-programme-overview-status">
          {% if submission.programme_report %}
            {{ govukTag({"text": "In progress", "classes": "govuk-tag--purple"}) }}
          {% else %}
            {{ govukTag({"text": "Not started yet", "classes": "govuk-tag--blue"}) }}
          {% endif %}
          </div>
        </li>
      </ul>

      <h2 class="govuk-heading-m">Project reports</h2>
      <ul class="govuk-task-list">
      {% for project in projects %}
        {% set statusId = 'task-list-' + (project_ref.id | string) + '-status' %}
          <li class="govuk-task-list__item govuk-task-list__item--with-link">
            <div class="govuk-task-list__name-and-hint">
              <a class="govuk-link govuk-task-list__link govuk-link--no-visited-state"
                 href="{{ url_for('report.project_reporting_home', programme_id=programme.id, project_id=project_ref.id) }}"
                 aria-describedby="{{ statusId }}">
                {{ project_ref.project_name }}
              </a>
            </div>

            <div class="govuk-task-list__status" id="{{ statusId }}">
            {% if (submission.projects|default({}))[project_ref.id|string] %}
              {{ govukTag({"text": "In progress", "classes": "govuk-tag--purple"}) }}
            {% else %}
              {{ govukTag({"text": "Not started yet", "classes": "govuk-tag--blue"}) }}
            {% endif %}
            </div>
          </li>
      {% endfor %}
      </ul>

    </div>
  </div>
{% endblock content %}
